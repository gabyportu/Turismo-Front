<!-- FONDO OSCURO (se cierra al hacer clic fuera) -->
<div class="fixed inset-0 bg-black/70 backdrop-blur-sm z-50" 
     (click)="cancelar()">
</div>

<!-- MODAL FLOTANTE PRINCIPAL -->
<div class="fixed inset-0 z-50 flex items-center justify-center p-4 md:p-8">
  <div class="w-full max-w-5xl max-h-screen overflow-y-auto bg-white rounded-3xl shadow-4xl border border-white/60"
       (click)="$event.stopPropagation()">

    <!-- BANDERA BOLIVIANA -->
    <div class="h-3 bg-gradient-to-r from-red-600 via-yellow-400 to-green-600 rounded-t-3xl"></div>

    <!-- HEADER -->
    <div class="text-center p-10 bg-gradient-to-b from-white/95 to-purple-50">
      <h1 class="text-5xl md:text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-[#6a1b9a] to-[#166534] drop-shadow-2xl">
        Nueva Empresa
      </h1>
      <p class="text-xl md:text-2xl font-medium text-gray-700 mt-4">Completa los datos en 2 pasos</p>
    </div>

    <!-- INDICADOR DE PASOS -->
    <div class="flex justify-center gap-12 md:gap-20 py-8 bg-white border-b">
      <div class="flex flex-col items-center">
        <div class="w-20 h-20 rounded-full flex items-center justify-center text-3xl font-bold shadow-2xl transition-all"
             [class.bg-[#6a1b9a]]="currentStep >= 1"
             [class.bg-[#166534]]="currentStep === 2"
             [class.text-white]="currentStep >= 1">
          1
        </div>
        <p class="mt-3 text-lg font-bold" [class.text-[#6a1b9a]]="currentStep >= 1">Datos Empresa</p>
      </div>

      <div class="w-24 md:w-40 h-1 bg-gray-300 my-10 rounded-full" 
           [class.bg-[#166534]]="currentStep === 2"></div>

      <div class="flex flex-col items-center">
        <div class="w-20 h-20 rounded-full flex items-center justify-center text-3xl font-bold shadow-2xl transition-all"
             [class.bg-gray-300]="currentStep < 2"
             [class.bg-[#166534]]="currentStep === 2"
             [class.text-white]="currentStep === 2">
          2
        </div>
        <p class="mt-3 text-lg font-bold" [class.text-[#166534]]="currentStep === 2">Responsable</p>
      </div>
    </div>

    <!-- CONTENIDO DE LOS PASOS -->
    <div class="p-8 md:p-12 bg-gradient-to-b from-white to-purple-50/20 min-h-[500px]">

      <!-- PASO 1 -->
      <div *ngIf="currentStep === 1" class="animate__animated animate__fadeIn">
        <app-step1-company (next)="onStep1Complete($event)"></app-step1-company>
      </div>

      <!-- PASO 2 -->
      <div *ngIf="currentStep === 2" class="animate__animated animate__fadeIn">
        <app-step2-company 
          (next)="onStep2Complete($event)" 
          (back)="currentStep = 1">
        </app-step2-company>
      </div>

    </div>

    <!-- BOTONES INFERIORES -->
    <div class="flex flex-col md:flex-row justify-between items-center gap-6 p-8 bg-gradient-to-r from-purple-100 to-green-100 rounded-b-3xl">
      
      <!-- CANCELAR -->
      <button mat-raised-button 
              color="warn" 
              class="w-full md:w-auto px-12 py-5 text-2xl font-bold rounded-2xl shadow-2xl hover:shadow-3xl transition-all transform hover:scale-105"
              (click)="cancelar()">
        <mat-icon class="text-3xl mr-3 align-middle">cancel</mat-icon>
        Cancelar
      </button>

      <div class="flex gap-6 w-full md:w-auto justify-end">
        <!-- ATRÁS -->
        <button *ngIf="currentStep === 2"
                mat-stroked-button 
                class="px-12 py-5 text-xl font-bold rounded-2xl shadow-xl"
                (click)="currentStep = 1">
          ← Atrás
        </button>

        <!-- SIGUIENTE / GUARDAR -->
        <button mat-raised-button 
                color="primary"
                class="px-16 py-5 text-2xl font-bold rounded-2xl shadow-2xl hover:shadow-3xl transition-all transform hover:scale-105"
                (click)="currentStep === 1 ? currentStep = 2 : saveCompany()">
          <span *ngIf="currentStep === 1">Siguiente →</span>
          <span *ngIf="currentStep === 2">
            <mat-icon class="text-3xl mr-2 align-middle">save</mat-icon>
            Guardar Empresa
          </span>
        </button>
      </div>
    </div>
  </div>
</div>